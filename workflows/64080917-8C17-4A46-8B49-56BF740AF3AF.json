{"actions":[{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionRunScript","parameters":{"script":"#coding: utf-8\nimport workflow\nimport editor\nimport colorsys\nimport ui\nimport re\n\ndef parse_hex(s):\n\tif s.startswith('#'):\n\t\ts = s[1:]\n\tif len(s) == 3:\n\t\ts = ''.join(c*2 for c in s)\n\tif re.match('[0-9A-Fa-f]{6}', s):\n\t\tr = int(s[:2], 16) \/ 255.0\n\t\tg = int(s[2:4], 16) \/ 255.0\n\t\tb = int(s[4:], 16) \/ 255.0\n\t\treturn (r, g, b)\n\treturn None\n\ndef slider_action(sender):\n\tsv = sender.superview\n\tmode = sv['mode_control'].selected_index\n\tif mode == 1:\n\t\th = sv['slider1'].value\n\t\ts = sv['slider2'].value\n\t\tb = sv['slider3'].value\n\t\trgb = colorsys.hsv_to_rgb(h, s, b)\n\telse:\n\t\tr = sv['slider1'].value\n\t\tg = sv['slider2'].value\n\t\tb = sv['slider3'].value\n\t\trgb = (r, g, b)\n\tsv['hex_label'].text = '%02x%02x%02x' % tuple(int(x*255) for x in rgb)\n\tsv['swatch'].background_color = rgb\n\ndef insert_action(sender):\n\thex_color = '#' + v['hex_label'].text\n\teditor.insert_text(hex_color)\n\tcursor = editor.get_selection()[0]\n\teditor.set_selection(cursor-len(hex_color), cursor)\n\tv.close()\n\ndef mode_action(sender):\n\tmode = sender.selected_index\n\tsv = sender.superview\n\tif mode == 1:\n\t\tsv['label1'].text = 'Hue'\n\t\tsv['label2'].text = 'Saturation'\n\t\tsv['label3'].text = 'Brightness'\n\telse:\n\t\tsv['label1'].text = 'Red'\n\t\tsv['label2'].text = 'Green'\n\t\tsv['label3'].text = 'Blue'\n\tc1 = sv['slider1'].value\n\tc2 = sv['slider2'].value\n\tc3 = sv['slider3'].value\n\tf = colorsys.rgb_to_hsv if mode == 1 else colorsys.hsv_to_rgb\n\tcolor = f(c1, c2, c3)\n\tsv['slider1'].value = color[0]\n\tsv['slider2'].value = color[1]\n\tsv['slider3'].value = color[2]\n\nclass TextFieldDelegate (object):\n\tdef textfield_did_change(self, tf):\n\t\tcolor = parse_hex(tf.text)\n\t\tif color:\n\t\t\tsv = tf.superview\n\t\t\tmode = sv['mode_control'].selected_index\n\t\t\tsv['swatch'].background_color = color\n\t\t\tif mode == 0:\n\t\t\t\tcolor = colorsys.rgb_to_hsv(*color)\n\t\t\tsv['slider1'].value = color[0]\n\t\t\tsv['slider2'].value = color[1]\n\t\t\tsv['slider3'].value = color[2]\n\t\t\t\nv = ui.load_view()\nv['mode_control'].action = mode_action\nv['hex_label'].delegate = TextFieldDelegate()\nv['hex_label'].autocapitalization_type = ui.AUTOCAPITALIZE_NONE\nbtn = ui.ButtonItem('Insert')\nbtn.action = insert_action\nbtn.tint_color = (0, 0.48, 1)\nv.right_button_items = [btn]\nsel_color = parse_hex(editor.get_selected_text())\nif sel_color:\n\tv['slider1'].value = sel_color[0]\n\tv['slider2'].value = sel_color[1]\n\tv['slider3'].value = sel_color[2]\nslider_action(v['slider1'])\nv.present('popover', title_color=0.3, title_bar_color='white')\n","ui":"[{\"frame\":\"{{0, 0}, {320, 240}}\",\"class\":\"View\",\"nodes\":[{\"frame\":\"{{91, 105.5}, {223, 34}}\",\"class\":\"Slider\",\"nodes\":[],\"attributes\":{\"flex\":\"W\",\"continuous\":true,\"enabled\":true,\"tint_color\":\"RGBA(0.000000,0.000000,0.000000,1.000000)\",\"action\":\"slider_action\",\"uuid\":\"79B90ABA-01F9-4712-B54D-150306D52D7D\",\"border_color\":\"RGBA(0.000000,0.000000,0.000000,1.000000)\",\"value\":0.5,\"name\":\"slider1\"}},{\"frame\":\"{{91, 147.5}, {223, 34}}\",\"class\":\"Slider\",\"nodes\":[],\"attributes\":{\"flex\":\"W\",\"continuous\":true,\"enabled\":true,\"tint_color\":\"RGBA(0.000000,0.000000,0.000000,1.000000)\",\"action\":\"slider_action\",\"uuid\":\"73AECEB3-3C43-4466-B6CA-72EB3E5ED61C\",\"border_color\":\"RGBA(0.000000,0.000000,0.000000,1.000000)\",\"value\":0.5,\"name\":\"slider2\"}},{\"frame\":\"{{91, 189.5}, {223, 34}}\",\"class\":\"Slider\",\"nodes\":[],\"attributes\":{\"flex\":\"W\",\"continuous\":true,\"enabled\":true,\"tint_color\":\"RGBA(0.000000,0.000000,0.000000,1.000000)\",\"action\":\"slider_action\",\"uuid\":\"22BD1989-F40E-4DB3-BA66-A3353D5EFFCB\",\"border_color\":\"RGBA(0.000000,0.000000,0.000000,1.000000)\",\"value\":0.5,\"name\":\"slider3\"}},{\"frame\":\"{{6, 6}, {154, 54.5}}\",\"class\":\"ImageView\",\"nodes\":[],\"attributes\":{\"flex\":\"WB\",\"uuid\":\"CB3F8791-1933-492E-A152-100FB5908341\",\"enabled\":true,\"border_color\":\"RGBA(0.000000,0.000000,0.000000,1.000000)\",\"name\":\"swatch\",\"corner_radius\":4}},{\"frame\":\"{{6, 105.5}, {77, 34}}\",\"class\":\"Label\",\"nodes\":[],\"attributes\":{\"flex\":\"\",\"font_size\":15,\"enabled\":true,\"border_color\":\"RGBA(0.000000,0.000000,0.000000,1.000000)\",\"text\":\"Red\",\"alignment\":\"right\",\"uuid\":\"99E84613-D5E6-4309-8EEA-3F4CD80D3C40\",\"name\":\"label1\",\"text_color\":\"RGBA(0.000000,0.000000,0.000000,1.000000)\"}},{\"frame\":\"{{6, 147}, {77, 34}}\",\"class\":\"Label\",\"nodes\":[],\"attributes\":{\"flex\":\"\",\"font_size\":15,\"enabled\":true,\"border_color\":\"RGBA(0.000000,0.000000,0.000000,1.000000)\",\"text\":\"Green\",\"alignment\":\"right\",\"uuid\":\"3F8ADE38-7F8B-480D-A39C-9C49D8CDCBBC\",\"name\":\"label2\",\"text_color\":\"RGBA(0.000000,0.000000,0.000000,1.000000)\"}},{\"frame\":\"{{6, 189}, {77, 34}}\",\"class\":\"Label\",\"nodes\":[],\"attributes\":{\"flex\":\"\",\"font_size\":15,\"enabled\":true,\"border_color\":\"RGBA(0.000000,0.000000,0.000000,1.000000)\",\"text\":\"Blue\",\"alignment\":\"right\",\"uuid\":\"518B0AFE-7994-4A13-B12B-BF53F8E0C584\",\"name\":\"label3\",\"text_color\":\"RGBA(0.000000,0.000000,0.000000,1.000000)\"}},{\"frame\":\"{{6, 68.5}, {308, 29}}\",\"class\":\"SegmentedControl\",\"nodes\":[],\"attributes\":{\"flex\":\"LR\",\"enabled\":true,\"tint_color\":\"RGBA(0.000000,0.000000,0.000000,1.000000)\",\"segments\":\"RGB|HSV\",\"uuid\":\"D434BF84-E1A9-4D4A-87CE-A683068EB78C\",\"border_color\":\"RGBA(0.000000,0.000000,0.000000,1.000000)\",\"name\":\"mode_control\"}},{\"frame\":\"{{199.5, 11}, {114.5, 43}}\",\"class\":\"TextField\",\"nodes\":[],\"attributes\":{\"uuid\":\"6F7EEEA5-83F1-48EA-9911-00F17EC38C93\",\"flex\":\"LB\",\"border_style\":3,\"border_color\":\"RGBA(0.000000,0.000000,0.000000,1.000000)\",\"alignment\":\"left\",\"autocorrection_type\":\"no\",\"enabled\":true,\"text\":\"ff0000\",\"text_color\":\"RGBA(0.000000,0.000000,0.000000,1.000000)\",\"spellchecking_type\":\"no\",\"name\":\"hex_label\",\"font_size\":28}},{\"frame\":\"{{173, 17}, {23.5, 32}}\",\"class\":\"Label\",\"nodes\":[],\"attributes\":{\"flex\":\"LB\",\"font_size\":32,\"enabled\":true,\"border_color\":\"RGBA(0.000000,0.000000,0.000000,1.000000)\",\"text\":\"#\",\"alignment\":\"right\",\"uuid\":\"A81479E0-9ED3-4C04-9DE1-23AAE7491836\",\"name\":\"label4\",\"text_color\":\"RGBA(0.509434,0.509434,0.509434,1.000000)\"}}],\"attributes\":{\"name\":\"Color\",\"enabled\":true,\"background_color\":\"RGBA(1.000000,1.000000,1.000000,1.000000)\",\"border_color\":\"RGBA(0.000000,0.000000,0.000000,1.000000)\",\"tint_color\":\"RGBA(0.000000,0.478000,1.000000,1.000000)\",\"flex\":\"\"}}]"}}]}