{"actions":[{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionRunScript","parameters":{"script":"#coding: utf-8\nimport editor\nimport workflow\nimport re\n\ndef get_next_footnote():\n\ttext = editor.get_text(True)\n\tfootnotes = set(re.findall('\\[\\^(.*?)\\]', text))\n\tmax_footnote = 0\n\tfor fn in footnotes:\n\t\ttry:\n\t\t\tfn_num = int(fn)\n\t\t\tmax_footnote = max(max_footnote, fn_num)\n\t\texcept ValueError:\n\t\t\tpass\n\treturn str(max_footnote+1)\n\nworkflow.set_output(get_next_footnote())\n"}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionStoreVariable","parameters":{"name":"Footnote Name","value":{"type":"advancedText","tokenRanges":{"{0, 1}":"Input"},"text":"?"}}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionRequestTextInput","parameters":{"multiLineOption":1,"text":{"selectedRange":"{0, 19}","tokenRanges":{"{18, 1}":"Footnote Name"},"type":"advancedText","text":"Text for footnote ?"},"title":"Insert Footnote...","textInputOptions":{"autoCorrectionEnabled":true,"keyboard.3":false,"autoCapitalizationEnabled":true,"keyboard.2":false,"spellCheckingEnabled":false,"keyboard.7":false,"keyboardType":0}}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionRunScript","parameters":{"script":"#coding: utf-8\nimport workflow\nimport editor\n\ntext = editor.get_text()\ncursor = editor.get_selection()[0]\nfn_name = workflow.get_variable('Footnote Name')\nfn_text = workflow.get_input()\n\nfootnote_def = '[^%s]: %s' % (fn_name, fn_text)\nfootnote_marker = '[^%s]' % (fn_name,)\nend = len(text)\neditor.replace_text(end, end, '\\n\\n' + footnote_def, False)\neditor.replace_text(cursor, cursor, footnote_marker, False)\n"}}]}