{"actions":[{"pauseBeforeRunning":false,"subActions":[{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionStopWorkflow","parameters":{"showHUD":true,"HUDTitle":"No Document Selected"}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionConditionEnd","parameters":{}}],"pauseWithoutShowingParameters":false,"customTitle":"A document has to be open...","class":"WorkflowActionCondition","parameters":{"comparisonType":0,"expression2":{"type":"advancedText","tokenRanges":{},"text":""},"expression1":{"type":"advancedText","tokenRanges":{"{0, 1}":"%editor:filename"},"text":"?"}}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionRunScript","parameters":{"script":"#coding: utf-8\nimport photos\nimport workflow\nimport console\nimport editor\nimport os\nimport io\n\nimg = photos.pick_image()\nif not img:\n\tworkflow.stop()\n\ndoc_path = editor.get_path()\ndoc_dir, fn = os.path.split(doc_path)\ndefault_name = 'Image'\ni = 1\nwhile True:\n\tif not os.path.exists(os.path.join(doc_dir, default_name + '.jpg')):\n\t\tbreak\n\tdefault_name = 'Image_' + str(i)\n\ti += 1\n\nroot, rel_doc_path = editor.to_relative_path(editor.get_path())\nfilename = console.input_alert('File Name', 'The image will be saved in the folder of the current document.', default_name + '.jpg', 'Save')\nif not filename:\n\tworkflow.stop()\nimg_data = io.BytesIO()\nimg.save(img_data, 'jpeg')\nrel_doc_dir, fn = os.path.split(rel_doc_path)\ndest_path = os.path.join(rel_doc_dir, filename)\neditor.set_file_contents(dest_path, img_data.getvalue(), root)\nworkflow.set_output(filename)\n"}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionReplaceSelectedText","parameters":{"replacement":{"selectedRange":"{2, 5}","tokenRanges":{"{9, 1}":"Input"},"type":"advancedText","text":"![Image](?)"}}}]}