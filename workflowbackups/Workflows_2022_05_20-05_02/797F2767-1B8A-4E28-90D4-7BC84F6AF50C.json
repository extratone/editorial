{"actions":[{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionSyncWithDropbox","parameters":{}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionStoreVariable","parameters":{"name":"key","value":{"type":"advancedText","tokenRanges":{},"text":"key"}}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionStoreVariable","parameters":{"name":"repo","value":{"type":"advancedText","tokenRanges":{},"text":"repo"}}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionGetFileName","parameters":{"includeFolder":false,"includeExtension":false}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionChangeCase","parameters":{"caseOption":1}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionFindReplace","parameters":{"replace":{"type":"advancedText","tokenRanges":{},"text":"-"},"find":{"type":"advancedText","tokenRanges":{},"text":" "},"findOption":0}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionStoreVariable","parameters":{"name":"filename","value":{"type":"advancedText","tokenRanges":{"{0, 1}":"Input"},"text":"?"}}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionStoreVariable","parameters":{"name":"path","value":{"type":"advancedText","tokenRanges":{"{9, 1}":"%date:MM","{13, 1}":"filename","{11, 1}":"%date:dd","{7, 1}":"%date:yyyy"},"text":"_posts\/?-?-?-?.markdown"}}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionGetFileName","parameters":{"includeFolder":false,"includeExtension":false}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionStoreVariable","parameters":{"name":"post_title","value":{"type":"advancedText","tokenRanges":{"{0, 1}":"Input"},"text":"?"}}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionRequestTextInput","parameters":{"title":"Tags (comma separated)","text":{"type":"advancedText","tokenRanges":{},"text":""},"multiLineOption":0}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionStoreVariable","parameters":{"name":"post_tags","value":{"type":"advancedText","tokenRanges":{"{0, 1}":"Input"},"text":"?"}}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionRunScript","parameters":{"script":"#coding: utf-8\nimport workflow\nimport datetime\n\n# Date logic adapted from http:\/\/stackoverflow.com\/a\/24740202\/371228\n\n# Get current local time and UTC time\nlocalnow = datetime.datetime.now()\nutcnow = datetime.datetime.utcnow()\n\n# Compute the time difference in seconds\ntzd = localnow - utcnow\nsecs = tzd.days*24*3600 + tzd.seconds\n\n# Get a positive or negative prefix\nprefix = '+'\nif secs < 0:\n\tprefix = '-'\n\tsecs = abs(secs)\n\n# Return the local time and the difference\nsuffix = \"%s%02d%02d\" % (prefix, secs\/3600, secs\/60%60)\n\nworkflow.set_output(suffix)\n"}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionStoreVariable","parameters":{"name":"post_timezone","value":{"type":"advancedText","tokenRanges":{"{0, 1}":"Input"},"text":"?"}}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionGetEditorText","parameters":{"foldedTextOption":0,"foldedTextReplacement":"…"}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionRunScript","parameters":{"script":"#coding: utf-8\nimport workflow\nimport re\n\naction_in = workflow.get_input()\n\n# Find all asset references\nimage_refs = re.findall(r'!\\[.*\\]\\(assets\\\/.*\\)', action_in)\nfind_result = '\\n'.join(str(ref) for ref in image_refs)\n\n# Remove markdown to only leave the actual path to the file\nreplace_result = re.sub(r'!\\[.*\\]\\(', '', find_result)\nreplace_result = re.sub(r'\\)', '', replace_result)\n\nworkflow.set_output(replace_result)\n"}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionRepeatWithLines","parameters":{"regex":{"type":"advancedText","tokenRanges":{},"text":"^assets"},"repeatOption":0}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionStoreVariable","parameters":{"name":"image_path","value":{"type":"advancedText","tokenRanges":{"{0, 1}":"Input"},"text":"?"}}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionRunScript","parameters":{"script":"#coding: utf-8\nimport workflow\nimport editor\nimport base64\nimport re\n\naction_in = workflow.get_variable('image_path')\nfile_path = editor.get_path()\ndocument_name = workflow.get_variable('post_title')\npath = re.sub(document_name + '.md', '', file_path)\npath = path + action_in\nwith open(path, 'r') as file:\n\tfile_contents = file.read()\n\taction_out = base64.b64encode(file_contents)\n\tworkflow.set_output(action_out)\n"}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionStoreVariable","parameters":{"name":"image_file_contents","value":{"type":"advancedText","tokenRanges":{"{0, 1}":"Input"},"text":"?"}}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionOpenURL","parameters":{"openIn":1,"URL":{"type":"advancedText","tokenRanges":{"{41, 1}":"key","{48, 1}":"repo","{64, 1}":"image_file_contents","{55, 1}":"image_path"},"text":"working-copy:\/\/x-callback-url\/write\/?key=?&repo=?&path=?&base64=?&x-success=editorial:\/\/workflow-callback"},"revealBrowserAutomatically":true,"tabOption":0,"URL:__URL_ESCAPE__":1,"waitUntilLoaded":false}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionShowHUD","parameters":{"HUDText":{"type":"advancedText","tokenRanges":{"{31, 1}":"Input"},"text":"Committed image to repository: ?"},"duration":0,"icon":0}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionRepeatWithLinesEnd","parameters":{}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionGetEditorText","parameters":{"foldedTextOption":0,"foldedTextReplacement":"…"}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionStoreVariable","parameters":{"name":"header","value":{"type":"advancedText","tokenRanges":{"{32, 1}":"%date:yyyy","{36, 1}":"%date:dd","{40, 1}":"%date:mm","{44, 1}":"post_timezone","{53, 1}":"post_tags","{34, 1}":"%date:MM","{38, 1}":"%date:HH","{42, 1}":"%date:ss","{24, 1}":"post_title"},"text":"---\nlayout: post\ntitle: ?\ndate: ?-?-? ?:?:? ?\ntags: [?]\n---\n\n"}}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionRunScript","parameters":{"script":"#coding: utf-8\nimport workflow\nimport base64\nimport editor\n\npath = editor.get_path()\nheader = workflow.get_variable('header')\nwith open(path, 'r') as file:\n\tfile_contents = file.read()\n\tfile_contents = header + file_contents\n\taction_out = base64.b64encode(file_contents)\n\tworkflow.set_output(action_out)\n"}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionStoreVariable","parameters":{"name":"text64","value":{"type":"advancedText","tokenRanges":{"{0, 1}":"Input"},"text":"?"}}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionOpenURL","parameters":{"openIn":1,"URL":{"type":"advancedText","tokenRanges":{"{77, 1}":"text64","{40, 1}":"key","{47, 1}":"repo","{68, 1}":"path","{112, 1}":"%editor:filename"},"text":"working-copy:\/\/x-callback-url\/chain?key=?&repo=?&command=write&path=?&base64=?&command=commit&limit=999&message=?%20updated&command=push&x-success=editorial:\/\/workflow-callback"},"revealBrowserAutomatically":true,"tabOption":0,"URL:__URL_ESCAPE__":1,"waitUntilLoaded":false}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionShowHUD","parameters":{"HUDText":{"type":"advancedText","tokenRanges":{"{8, 1}":"%editor:filename"},"text":"Article ? published!"},"duration":2,"icon":0}}]}