{"actions":[{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionGetFileName","parameters":{"includeFolder":false,"includeExtension":true}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"Declare filename variable","class":"WorkflowActionStoreVariable","parameters":{"name":"Filename","value":{"type":"advancedText","tokenRanges":{"{0, 1}":"Input"},"text":"?"}}},{"pauseBeforeRunning":false,"colorLabel":2,"pauseWithoutShowingParameters":false,"customTitle":"Run Python Script (Custom parameters!)","class":"WorkflowActionCustom","parameters":{"__custom_action_script__":"# coding: utf-8\n\"\"\"\nPython code to exchange files with a webdav server directory.\nFor org files it aims to offer a conversion to markdown for local editing\nand allow the markdown to be pushed back as org file, without the loss of\nany org specific stuff.\n\"\"\"\nfrom datetime import datetime\nimport dialogs\nimport editor\nimport email.utils as eut\nfrom httplib2 import Http\nimport keychain\nfrom os import path\nimport re\nfrom StringIO import StringIO\nimport xml.etree.ElementTree as ET\nimport workflow\n\n# Fetch workflow parameters\nPARAMS = workflow.get_parameters()\n\n# User defined 'constants' taken from parameters\nURL = PARAMS['Url']\nUSER = PARAMS['User']\nFILE_TYPE = PARAMS['FileType']\nWIPE_PASSWORD = PARAMS['WipePassword']\n\n# Supported extensions\nMARKDOWN_EXT = 'md'\nORG_EXT = 'org'\nTASKPAPER_EXT = 'taskpaper'\nTEXT_EXT = 'txt'\n\n# Mapping file types to extensions\nFILE_TYPES = {\n\t\t0: MARKDOWN_EXT,\n\t\t1: ORG_EXT,\n\t\t2: TASKPAPER_EXT,\n\t\t3: TEXT_EXT\n}\n\n\ndef handle_not_allowed(status):\n\t\t\"\"\" Handle a possible not allowed status\n\t\t\"\"\"\n\t\t# When access is denied, wipe stored password\n\t\tif status in ['401']:\n\t\t\t\tkeychain.delete_password(URL, USER)\n\n\ndef get_file(client, file_name):\n\t\t\"\"\" Get a file from webdav with the given name\n\t\t\"\"\"\n\t\tres, contents = client.request(\n\t\t\t\turi='%s\/%s' % (URL, file_name),\n\t\t\t\tmethod='GET')\n\t\tstatus = res['status']\n\t\tif status not in ['200', '201']:\n\t\t\t\thandle_not_allowed(status)\n\t\t\t\traise Exception('Bad return state: %s' % (status))\n\t\treturn contents\n\n\ndef delete_file(client, file_name):\n\t\t\"\"\" Delete a file from webdav with the given name\n\t\t\"\"\"\n\t\tres, contents = client.request(\n\t\t\t\turi='%s\/%s' % (URL, file_name),\n\t\t\t\tmethod='DELETE'\n\t\t)\n\t\tstatus = res['status']\n\t\tif status not in ['200', '204']:\n\t\t\t\thandle_not_allowed(status)\n\t\t\t\traise Exception('Bad return state: %s' % (status))\n\n\ndef put_file(client, file_name, file_content):\n\t\t\"\"\" Put a file on webdav with the given name and content\n\t\t\"\"\"\n\t\tres, content = client.request(\n\t\t\t\turi='%s\/%s' % (URL, file_name),\n\t\t\t\tmethod='PUT',\n\t\t\t\theaders={'Content-Type': 'text\/plain; charset=\"utf-8\"'},\n\t\t\t\tbody=file_content\n\t\t)\n\t\tstatus = res['status']\n\t\tif status not in ['200', '201']:\n\t\t\t\thandle_not_allowed(status)\n\t\t\t\traise Exception('Bad return state: %s' % (status))\n\n\ndef conv_datetime(value):\n\t\t\"\"\" Convert WebDAV date time to something local and compact\n\t\t\"\"\"\n\t\ttry:\n\t\t\t\ttup = eut.parsedate_tz(value)\n\t\t\t\ttimestamp = eut.mktime_tz(tup)\n\t\t\t\tdt = datetime.fromtimestamp(timestamp)\n\t\t\t\treturn dt.strftime('%Y-%m-%d %H:%M:%S')\n\t\texcept:\n\t\t\t\treturn '?'\n\n\ndef get_props_from_xml(node, namespaces, extension):\n\t\t\"\"\" Obtain dir entry props from xml or None if irrelevant\n\t\t\"\"\"\n\t\t# Full path\n\t\tfile_path = node.find('d:href', namespaces).text\n\n\t\t# Only interested in org files\n\t\tparts = path.splitext(file_path)\n\t\tfile_ext = (parts[1] if len(parts) > 1 else '').strip('.')\n\n\t\t# Ignore no or wring extension\n\t\tif file_ext != extension:\n\t\t\t\treturn None\n\n\t\tprop = node.find('d:propstat\/d:prop', namespaces)\n\n\t\t# Must be a dir or something unexpected\n\t\tif (prop is None or\n\t\t\t\t\t\tprop.find('d:getcontentlength', namespaces) is None):\n\t\t\t\treturn None\n\n\t\t# Get basic properties\n\t\tbase_name = path.basename(file_path)\n\t\tresult = {\n\t\t\t\t'file_name': base_name,\n\t\t\t\t'name': path.splitext(base_name)[0],\n\t\t\t\t'extension': file_ext,\n\t\t\t\t'length': int(prop.find('d:getcontentlength', namespaces).text),\n\t\t\t\t'modified': conv_datetime(\n\t\t\t\t\t\tprop.find('d:getlastmodified', namespaces).text),\n\t\t\t\t'content_type': prop.find('d:getcontenttype', namespaces).text\n\t\t}\n\n\t\t# Construct the title\n\t\tresult['title'] = ('%s [%s] %s' %\n\t\t\t\t\t\t\t\t\t\t\t (result['name'],\n\t\t\t\t\t\t\t\t\t\t\t\tresult['length'],\n\t\t\t\t\t\t\t\t\t\t\t\tresult['modified']))\n\t\treturn result\n\n\ndef parse_dir_xml(xml):\n\t\t\"\"\" Parse directory XML and return a dict with entries\n\t\t\"\"\"\n\n\t\t# Determine extension of interest\n\t\textension = FILE_TYPES[FILE_TYPE]\n\n\t\troot = ET.fromstring(xml)\n\t\tnamespaces = {'d': 'DAV:'}\n\t\tresult = []\n\t\tfor resp in root.findall('d:response', namespaces):\n\t\t\t\tprop_dict = get_props_from_xml(resp, namespaces, extension)\n\t\t\t\tif prop_dict is not None:\n\t\t\t\t\t\tresult.append(prop_dict)\n\t\t# Return list sorted by title\n\t\treturn sorted(result, key=lambda k: k['title'].lower())\n\n\ndef get_dir(client):\n\t\t\"\"\" Obtain a webdav dir and return a dict with entries\n\t\t\"\"\"\n\t\txml = \"\"\"\n\t\t\t\t<?xml version=\"1.0\" encoding=\"utf-8\" ?>\n\t\t\t\t<propfind xmlns=\"DAV:\">\n\t\t\t\t\t<prop><getcontentlength\/><\/prop>\n\t\t\t\t\t<prop><getcontenttype\/><\/prop>\n\t\t\t\t\t<prop><getlastmodified\/><\/prop>\n\t\t\t\t<\/propfind>\"\"\"\n\t\tres, content = client.request(\n\t\t\t\turi=URL,\n\t\t\t\tmethod='PROPFIND',\n\t\t\t\theaders={'Content-Type': 'application\/xml; charset=\"utf-8\"',\n\t\t\t\t\t\t\t\t 'Depth': '1'},\n\t\t\t\tbody=xml\n\t\t)\n\t\tstatus = res['status']\n\t\tif status not in ['200', '207']:\n\t\t\t\thandle_not_allowed(status)\n\t\t\t\traise Exception('Bad return state: %s' % (status))\n\n\t\treturn parse_dir_xml(content)\n\n\ndef get_file_path(file_name):\n\t\t\"\"\" Get file path including any subdir\n\t\t\"\"\"\n\t\tcur_dir = editor.get_selected_folder()[1]\n\t\tif cur_dir == '\/':\n\t\t\t\treturn cur_dir + file_name\n\t\treturn cur_dir + '\/' + file_name\n\n\ndef select_remote_file(client, file_name, method):\n\t\t\"\"\" Select a remote file\n\t\t\"\"\"\n\t\t# Obtain (relevant) dictory entries\n\t\tdir_entries = get_dir(client)\n\n\t\t# Nothing to select\n\t\tif len(dir_entries) < 1:\n\t\t\t\tdialogs.alert('There is nothing to select',\n\t\t\t\t\t\t\t\t\t\t\tbutton1='OK',\n\t\t\t\t\t\t\t\t\t\t\thide_cancel_button=True)\n\t\t\t\tworkflow.stop()\n\n\t\t# Add marker at current file\n\t\tname = path.splitext(file_name)[0]\n\t\tfor entry in dir_entries:\n\t\t\t\tprefix = '>' if entry['name'] == name else '-'\n\t\t\t\tentry['title'] = prefix + ' ' + entry['title']\n\n\t\t# Select a file\n\t\tselected = dialogs.list_dialog(\n\t\t\t\tmethod.capitalize() + ' file', dir_entries)\n\n\t\tif selected is None:\n\t\t\t\tworkflow.stop()\n\n\t\treturn selected\n\n\ndef obtain_password():\n\t\t\"\"\" Obtain password from keychain or ask user to provide it\n\t\t\"\"\"\n\t\t# Password wipe requested\n\t\tif WIPE_PASSWORD > 0:\n\t\t\t\tkeychain.delete_password(URL, USER)\n\n\t\tpassword = keychain.get_password(URL, USER)\n\t\tif password is not None:\n\t\t\t\treturn password\n\n\t\tpassword = dialogs.password_alert(\n\t\t\t\t'Please enter password for user %s' % (USER))\n\t\tif password is None:\n\t\t\t\tworkflow.stop()\n\n\t\t# Store for the next run\n\t\tkeychain.set_password(URL, USER, password)\n\t\treturn password\n\n\ndef handle_push(client, file_name):\n\t\t\"\"\" Handle push of file to webdav\n\t\t\"\"\"\n\t\tfile_path = get_file_path(file_name)\n\t\teditor.close()\n\n\t\t# Obtain edited data\n\t\tdata = editor.get_file_contents(file_path)\n\n\t\t# Remote extension\n\t\tremote_ext = FILE_TYPES[FILE_TYPE]\n\n\t\t# Convert to org when required\n\t\tif remote_ext == ORG_EXT:\n\t\t\t\tdata = md_to_org(data)\n\n\t\t# Replace file extension on remote end\n\t\tremote_file = path.splitext(file_name)[0] + '.' + remote_ext\n\n\t\t# Write to webdav\n\t\tput_file(client, remote_file, data)\n\t\tdialogs.hud_alert('Successfully transfered %s file' % (remote_file),\n\t\t\t\t\t\t\t\t\t\t\t'success')\n\t\tworkflow.set_variable('Filename', file_path)\n\n\ndef handle_pull(client, file_name):\n\t\t\"\"\" Handle pull of file from webdav\n\t\t\"\"\"\n\t\tselected = select_remote_file(client, file_name, 'fetch')\n\n\t\tremote_ext = FILE_TYPES[FILE_TYPE]\n\t\tremote_file = selected['file_name']\n\n\t\t# Set local extension to markdown if remote extension is org\n\t\tlocal_ext = MARKDOWN_EXT if remote_ext == ORG_EXT else remote_ext\n\n\t\t# Local file name with the proper extension\n\t\tlocal_file = ('%s.%s' %\n\t\t\t\t\t\t\t\t\t(path.splitext(get_file_path(remote_file))[0], local_ext))\n\n\t\tif editor.get_file_contents(local_file) is not None:\n\t\t\t\tif dialogs.alert('Overwrite existing?', button1='OK') != 1:\n\t\t\t\t\t\tworkflow.stop()\n\n\t\t# Read from webdav\n\t\tdata = get_file(client, remote_file)\n\n\t\t# Convert to markdown when required\n\t\tif remote_ext == ORG_EXT:\n\t\t\t\tdata = org_to_md(data)\n\n\t\t# Write content\n\t\teditor.set_file_contents(local_file, data)\n\t\tworkflow.set_variable('Filename', local_file)\n\n\ndef handle_delete(client, file_name):\n\t\t\"\"\" Handle delete of file from webdav\n\t\t\"\"\"\n\t\tselected = select_remote_file(client, file_name, 'delete')\n\n\t\tselected_file = selected['file_name']\n\t\tif dialogs.alert('Delete %s?' % (selected_file), button1='OK') != 1:\n\t\t\t\tworkflow.stop()\n\t\tdelete_file(client, selected_file)\n\t\tdialogs.hud_alert('Successfully deleted %s' % (selected_file),\n\t\t\t\t\t\t\t\t\t\t\t'success')\n\n\ndef allow_push(file_name):\n\t\t\"\"\" Check if pushing is allowed\n\t\t\"\"\"\n\t\t# Obtain extension (if any)\n\t\tparts = path.splitext(file_name.lower())\n\t\tif len(parts) < 2:\n\t\t\t\treturn False\n\t\text = parts[1].lstrip('.')\n\t\t# With org file type, require local markdown\n\t\tif FILE_TYPES[FILE_TYPE] == ORG_EXT:\n\t\t\t\treturn ext == MARKDOWN_EXT\n\t\t# Require extension match with file type\n\t\treturn FILE_TYPES[FILE_TYPE] == ext\n\n\ndef org_to_md(data):\n\t\t\"\"\" Convert org format to md\n\t\t\"\"\"\n\t\tres = []\n\t\tliteral = False\n\t\t# Lines starting withn one or more '*' => '#'\n\t\tpat_hdr = re.compile('^[*]+')\n\t\t# [[link][description]] => [description](link)\n\t\tpat_lnk = re.compile('\\[\\[(.*)\\]\\[(.*)\\]\\]')\n\t\t# [[link]] => ![image](link)\n\t\tpat_lni = re.compile('\\[\\[(.*)\\]\\]')\n\t\t# *some text* => **some text**\n\t\tpat_bold = re.compile('\\*([^*]+)\\*(?=(\\s|$|\/))')\n\t\t# \/some text\/ => *some text*\n\t\tpat_italic = re.compile('(?<=\\s)?\/([^\/]+)\/(?=(\\s|$))')\n\t\t# :block quotes => >block quotes\n\t\tpat_blk = re.compile('(?=\\s)*:')\n\n\t\ts = StringIO(data)\n\t\twhile True:\n\t\t\t\tline = s.readline()\n\t\t\t\tif not line:\n\t\t\t\t\t\tbreak\n\n\t\t\t\t# Clean any cr\/lf or trailing whitespace\n\t\t\t\tline = line.rstrip(' \\r\\n\\t')\n\n\t\t\t\t# Create leading whitespace stripped lowercase line for checking\n\t\t\t\tcheck_line = line.lstrip(' \\t').lower()\n\n\t\t\t\t# Replace hash lines with an empty link (due to lack of alternatives),\n\t\t\t\t# so they gray out and are invisible on HTML exports.\n\t\t\t\t# Add backticks at #+begin_ and #+end_ lines for literal display,\n\t\t\t\t# unless it is HTML.\n\t\t\t\tif check_line.startswith('#+'):\n\t\t\t\t\t\t# Replace round brackets by curly ones, because round ones mess\n\t\t\t\t\t\t# up the link syntax.\n\t\t\t\t\t\tline = line.replace('(', '{').replace(')', '}')\n\t\t\t\t\t\tif check_line.startswith('#+end_'):\n\t\t\t\t\t\t\t\tif not check_line.startswith('#+end_html'):\n\t\t\t\t\t\t\t\t\t\tres.append('```')\n\t\t\t\t\t\t\t\tliteral = False\n\n\t\t\t\t\t\tres.append('[](%s)' % (line))\n\t\t\t\t\t\tif check_line.startswith('#+begin_'):\n\t\t\t\t\t\t\t\t# When required add another line before the literal block\n\t\t\t\t\t\t\t\tif len(res) > 0 and res[len(res) - 1] != '':\n\t\t\t\t\t\t\t\t\t\tres.append('')\n\t\t\t\t\t\t\t\tif not check_line.startswith('#+begin_html'):\n\t\t\t\t\t\t\t\t\t\tres.append('```')\n\t\t\t\t\t\t\t\tliteral = True\n\t\t\t\t\t\tcontinue\n\n\t\t\t\t# When in literal mode, just add what is found\n\t\t\t\tif literal:\n\t\t\t\t\t\tres.append(line)\n\t\t\t\t\t\tcontinue\n\n\t\t\t\t# Replace any links encountered\n\t\t\t\tline = re.sub(pat_lnk,\n\t\t\t\t\t\t\t\t\t\t\tlambda m: '[%s](%s)' % (m.group(2), m.group(1)),\n\t\t\t\t\t\t\t\t\t\t\tline)\n\t\t\t\tline = re.sub(pat_lni,\n\t\t\t\t\t\t\t\t\t\t\tlambda m: '![image](%s)' % (m.group(1)),\n\t\t\t\t\t\t\t\t\t\t\tline)\n\n\t\t\t\t# Replace bold\n\t\t\t\tline = re.sub(pat_bold,\n\t\t\t\t\t\t\t\t\t\t\tlambda m: '**%s**' % (m.group(1)),\n\t\t\t\t\t\t\t\t\t\t\tline)\n\n\t\t\t\t# Replace italic\n\t\t\t\tline = re.sub(pat_italic,\n\t\t\t\t\t\t\t\t\t\t\tlambda m: '*%s*' % (m.group(1)),\n\t\t\t\t\t\t\t\t\t\t\tline)\n\n\t\t\t\t# Replace headers\n\t\t\t\tif line.startswith('*'):\n\t\t\t\t\t\t# Add empty line when required before markdown headers\n\t\t\t\t\t\tif len(res) > 0 and res[len(res) - 1] != '':\n\t\t\t\t\t\t\t\tres.append('')\n\t\t\t\t\t\t# Actual replace\n\t\t\t\t\t\tres.append(\n\t\t\t\t\t\t\t\tre.sub(pat_hdr,\n\t\t\t\t\t\t\t\t\t\t\t lambda x: x.group(0).replace('*', '#'),\n\t\t\t\t\t\t\t\t\t\t\t line))\n\n\t\t\t\t# Handle tables\n\t\t\t\telif check_line.startswith('|'):\n\t\t\t\t\t\t# Precede with empty line when required\n\t\t\t\t\t\tif len(res) > 0:\n\t\t\t\t\t\t\t\tprev_line = res[len(res) - 1].strip()\n\t\t\t\t\t\telse:\n\t\t\t\t\t\t\t\tprev_line = ''\n\t\t\t\t\t\tif not prev_line.startswith('|') and prev_line != '':\n\t\t\t\t\t\t\t\tres.append('')\n\t\t\t\t\t\t# Replace any heading '+' chars\n\t\t\t\t\t\tif check_line.startswith('|-'):\n\t\t\t\t\t\t\t\tres.append(line.replace('+', '|'))\n\t\t\t\t\t\t# Otherwise just add\n\t\t\t\t\t\telse:\n\t\t\t\t\t\t\t\tres.append(line)\n\n\t\t\t\t# Block quote\n\t\t\t\telif check_line.startswith(':'):\n\t\t\t\t\t\tres.append(re.sub(pat_blk, '>', line))\n\n\t\t\t\t# Just add as is\n\t\t\t\telse:\n\t\t\t\t\t\tres.append(line)\n\n\t\treturn '\\n'.join(res) + '\\n'\n\n\ndef md_to_org(data):\n\t\t\"\"\" Convert md format to org\n\t\t\"\"\"\n\t\tres = []\n\t\tliteral = False\n\t\tdel_next_blank = False\n\t\t# # => *\n\t\tpat_hdr = re.compile('^[#]+')\n\t\t# #Text => # Text\n\t\tpat_hds = re.compile('^#+(?=[^#\\s])')\n\t\t# [description](link) => [[link][description]]\n\t\tpat_lnk = re.compile('\\[(.*)\\]\\((.*)\\)')\n\t\t# ![image](link) => [[link]]\n\t\tpat_lni = re.compile('!\\[image\\]\\((.*)\\)')\n\t\t# * (list bullet) => +\n\t\tpat_ast = re.compile('(^\\s*\\*)(?=\\s)')\n\t\t# *some text* => \/some text\/\n\t\tpat_italic = re.compile('(?<!\\*)\\*([^*]+)\\*')\n\t\t# ***some text*** => \/*some text*\/\n\t\tpat_bolditalic = re.compile('\\*{3}([^*]+)\\*{3}')\n\t\t# **some text** => *some text*\n\t\tpat_bold = re.compile('\\*{2}([^*]+)\\*{2}')\n\t\t# :block quotes => >block quotes\n\t\tpat_blk = re.compile('(?=\\s)*>')\n\n\t\ts = StringIO(data)\n\t\twhile True:\n\t\t\t\tline = s.readline()\n\t\t\t\tif not line:\n\t\t\t\t\t\tbreak\n\n\t\t\t\t# Clean any trailing whitespace\n\t\t\t\tline = line.rstrip(' \\r\\n\\t')\n\n\t\t\t\t# Create leading whitespace stripped lowercase line for checking\n\t\t\t\tcheck_line = line.lstrip(' \\t').lower()\n\n\t\t\t\t# Skip next blank line is set\n\t\t\t\tif del_next_blank and len(line) < 1:\n\t\t\t\t\t\tcontinue\n\t\t\t\tdel_next_blank = False\n\n\t\t\t\t# Skip multiple blank lines\n\t\t\t\tif len(line) < 1 and len(res) > 0 and len(res[len(res) - 1]) == 0:\n\t\t\t\t\t\tcontinue\n\n\t\t\t\t# Restore hash lines\n\t\t\t\tif line.startswith('[](#+'):\n\t\t\t\t\t\t# Replace curly brackets by round ones\n\t\t\t\t\t\thash_line = line[3:-1].replace('{', '(').replace('}', ')')\n\t\t\t\t\t\tif check_line.find('#+begin_') >= 0:\n\t\t\t\t\t\t\t\tliteral = True\n\t\t\t\t\t\t\t\tdel_next_blank = True\n\t\t\t\t\t\telif check_line.lower().find('#+end_') >= 0:\n\t\t\t\t\t\t\t\tliteral = False\n\t\t\t\t\t\telif check_line.lower().find('#+results:') >= 0:\n\t\t\t\t\t\t\t\tdel_next_blank = True\n\t\t\t\t\t\tres.append(hash_line)\n\t\t\t\t\t\tcontinue\n\n\t\t\t\t# Remove any literal markers\n\t\t\t\tif line.startswith('```'):\n\t\t\t\t\t\tcontinue\n\n\t\t\t\t# When in literal mode, just add what is found\n\t\t\t\tif literal:\n\t\t\t\t\t\tres.append(line)\n\t\t\t\t\t\tcontinue\n\n\t\t\t\t# Replace links\n\t\t\t\tline = re.sub(pat_lni,\n\t\t\t\t\t\t\t\t\t\t\tlambda m: '[[%s]]' % (m.group(1)),\n\t\t\t\t\t\t\t\t\t\t\tline)\n\t\t\t\tline = re.sub(pat_lnk,\n\t\t\t\t\t\t\t\t\t\t\tlambda m: '[[%s][%s]]' % (m.group(2), m.group(1)),\n\t\t\t\t\t\t\t\t\t\t\tline)\n\n\t\t\t\t# Replace indented asterisks\n\t\t\t\tline = re.sub(pat_ast,\n\t\t\t\t\t\t\t\t\t\t\tlambda x: x.group(0).replace('*', '+'),\n\t\t\t\t\t\t\t\t\t\t\tline)\n\n\t\t\t\t# Replace italic\n\t\t\t\tline = re.sub(pat_italic,\n\t\t\t\t\t\t\t\t\t\t\tlambda m: '\/%s\/' % (m.group(1)),\n\t\t\t\t\t\t\t\t\t\t\tline)\n\n\t\t\t\t# Replace bolditalic\n\t\t\t\tline = re.sub(pat_bolditalic,\n\t\t\t\t\t\t\t\t\t\t\tlambda m: '\/*%s*\/' % (m.group(1)),\n\t\t\t\t\t\t\t\t\t\t\tline)\n\n\t\t\t\t# Replace bold\n\t\t\t\tline = re.sub(pat_bold,\n\t\t\t\t\t\t\t\t\t\t\tlambda m: '*%s*' % (m.group(1)),\n\t\t\t\t\t\t\t\t\t\t\tline)\n\n\t\t\t\t# Replace headers\n\t\t\t\tif line.startswith('#'):\n\t\t\t\t\t\t# Force a space between header markers and text\n\t\t\t\t\t\tline = re.sub(pat_hds,\n\t\t\t\t\t\t\t\t\t\t\t\t\tlambda x: x.group(0) + ' ',\n\t\t\t\t\t\t\t\t\t\t\t\t\tline)\n\t\t\t\t\t\t# Replace # by *\n\t\t\t\t\t\tres.append(\n\t\t\t\t\t\t\t\tre.sub(pat_hdr,\n\t\t\t\t\t\t\t\t\t\t\t lambda x: x.group(0).replace('#', '*'),\n\t\t\t\t\t\t\t\t\t\t\t line))\n\n\t\t\t\t# Handle tables\n\t\t\t\telif check_line.startswith('|-'):\n\t\t\t\t\t\t# Restore heading plusses\n\t\t\t\t\t\tres.append(line.replace('-|-', '-+-'))\n\n\t\t\t\t# Block quote\n\t\t\t\telif check_line.startswith('>'):\n\t\t\t\t\t\tres.append(re.sub(pat_blk, ':', line))\n\n\t\t\t\t# Just add as is\n\t\t\t\telse:\n\t\t\t\t\t\tres.append(line)\n\n\t\treturn '\\n'.join(res) + '\\n'\n\n\n# --- Main program ---\n\ntry:\n\n\t\t# Obtain password from user (once)\n\t\tpassword = obtain_password()\n\t\t\n\t\t# Setup client\n\t\tclient = Http(disable_ssl_certificate_validation=True)\n\t\tclient.add_credentials(USER, password)\n\t\t\n\t\t# Obtain current file name (if any)\n\t\tfile_name = workflow.get_variable('Filename')\n\t\t\n\t\t# Offer selection of options\n\t\t# Fill options\n\t\toptions = []\n\t\toptions.append({'title': '- From WebDAV', 'action': 1})\n\t\tif allow_push(file_name):\n\t\t\t\toptions.append({'title': '- To WebDAV', 'action': 2})\n\t\toptions.append({'title': '- Delete WebDAV file', 'action': 3})\n\t\tselected = dialogs.list_dialog('Select Action', options)\n\t\tif selected is None:\n\t\t\t\tworkflow.stop()\n\t\taction = selected['action']\n\t\t\n\t\t# Act on selected option\n\t\tif action == 2:\n\t\t\t\thandle_push(client, file_name)\n\t\telif action == 3:\n\t\t\t\thandle_delete(client, file_name)\n\t\telse:\n\t\t\t\thandle_pull(client, file_name)\nexcept KeyboardInterrupt:\n    pass\nexcept Exception as e:\n\t\tdialogs.alert('Oops: ' + str(e))\n","A83A37A8-3518-498D-9C0C-4AE7B17FFEED":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"A32C7694-9340-429A-9EE1-6E536AC981BB":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"84D49480-124B-4A84-A565-1DFFF8E96109":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"21AB9E20-B7BF-48AA-9EAA-9273318207C1":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"B5D68F22-ED0E-4E54-B18E-D86DA52476B1":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap and hold the action to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"7EB87629-5819-4685-8889-02E49FF4DAB9":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"A6ED1E52-B3B6-46D1-BFAC-917BBD017818":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"E1F6F53C-0998-4C6E-AC9E-6003BCC9FD28":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"830A5C5D-D7F1-414C-85C9-D4A1335077B7":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"879002D1-448C-49A7-9059-975C39491505":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap and hold the action to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"74C26BE0-7C95-4A6B-9402-5BBA17E925B4":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"41587A2D-C6A3-42CF-9C20-71F08469C7DC":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"1AF879C6-6B13-45F9-9028-46BDD4F6D414":"davidblue","CDF63731-2F64-4C9B-8FB0-E4727FB0D84D":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"85DB9A37-E044-4C37-8970-CD0316F6183D":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"A372F341-AABE-4109-8635-9047F62E066F":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"AF445E80-C024-4F6E-8D70-3F6D241C1E5D":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap and hold the action to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"4C05C63A-A194-48A1-BB3D-1017DF40E5E6":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"169DD833-0B1B-4B36-9CA2-DF12EDEC6255":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"96B78621-8FDE-4DD9-9738-7F6DAACDCA23":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"69EFFD99-E3D8-4262-82AD-85EFE2D39E50":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"CE96AF8C-C42D-4495-BE18-F119F91BB815":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"7C1B0FA9-4005-4D5B-AC3A-2F80160851E1":1,"D51D6CA4-F96E-444C-902C-C365AFC00F3B":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"62559C39-ECF6-4D58-8067-05713417FE7F":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"61C3BD8B-BFC8-4253-AF52-5258FAAF6AD0":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"0E288A3A-7B4B-4394-83FA-B3F77629B197":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"5B6DF524-3B40-4408-A3F4-FA5E7E2EA1E8":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"5D648034-4B92-49E4-BA15-3F03A8A46FDF":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"__custom_action_parameters__":[{"keyboardType":0,"key":"1AF879C6-6B13-45F9-9028-46BDD4F6D414","title":"User","type":"basicText"},{"keyboardType":3,"key":"66F79C0F-FE3B-4BE6-8798-EE177936BCA7","title":"Url","type":"basicText"},{"key":"7C1B0FA9-4005-4D5B-AC3A-2F80160851E1","title":"FileType","type":"selectOption","optionTitles":["Markdown","Org","TaskPaper","Text"]},{"key":"4F80D5B2-2CF9-4FD2-8BE7-DB7CABB3CED1","title":"WipePassword","type":"selectOption","optionTitles":["No","Yes"]}],"E1A97C5B-E87A-4890-B297-8CC175EEDD6C":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"562D5C5E-908D-4662-920E-C8EC918B82C1":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"E6C11620-AEF6-4990-B82C-241E949A8E71":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"5FA428FE-621D-4F52-8044-4F3AFE4AFAF2":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"04E7E923-581F-4E8A-8DAC-DA1D35941A1D":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"9555D6DB-27EA-406C-BA68-18C551AF94F0":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"DCB730F0-7B82-470A-9780-C0F25FD29AE8":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"8A17CBDC-CF82-4125-B34E-0AC98B23CC56":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"A15F1444-7EDD-45F6-8303-916CFC1A30BC":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap and hold the action to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"78E5B0CD-5B95-4B5B-BD5A-8D4904A31FC8":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"11F59859-3EE3-4661-9DAF-026AB1DCD658":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap and hold the action to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"9C987A24-E135-4E7E-A653-072A2125DF8E":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"10EBD1DA-86CC-4B13-875E-13CC673317DF":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"6D71426D-E9B7-440F-A80A-098D4E88E1B5":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"66F79C0F-FE3B-4BE6-8798-EE177936BCA7":"https:\/\/neocities.org\/webdav\/webdav_dir","3A17D49A-2182-4A93-93E4-AD0138AA5697":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"242A469C-0C63-41F5-8769-F3AB029B7406":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"1451D556-9B62-4E16-B214-43508ACE6AA2":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"51605EE9-E74C-4A0B-B1B0-0B526F5792F7":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"38E85BB4-042E-4ACB-85C5-4D25EF12DC89":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"0CDB93C8-6B3F-400C-BFB8-89C0FD9E32B6":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"24196C68-5A08-4236-B850-FD6D344B30F8":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"4F80D5B2-2CF9-4FD2-8BE7-DB7CABB3CED1":0,"EAE2DEA8-3514-46A8-8B7A-69550F27A6AF":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"D3EDE190-8D4F-4988-99B0-4EA3940E1B68":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"570BF1E7-2B97-4A7B-B9E7-C1D5DF6F591E":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"2FD1819A-29E6-4016-8E06-0D8267DFC267":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"A2CAA012-7047-4CB8-8A67-FC9BDC1D3086":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"CA2D174D-AA40-4BAD-BB58-FEDDF1C9E499":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"BA642C61-91F3-4FDF-B6CC-4B9CEB4C87FD":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"A45C0511-BBD2-4F6C-8CA4-6E800E636BE5":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"22745164-A979-49AF-A543-1FAF2D94B20D":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"0485AD19-AC7E-43C7-8574-026A1F9DA506":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"6513F6CF-4D06-4171-9888-D223A7602DB7":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"CC947383-F612-4AD2-8E47-A7D9CD954E38":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"ECBAC193-96AD-48A5-ACF7-D23D4DCA02AF":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"5CDD48B2-1EB0-4C69-9FBA-6DB70FC1D6E8":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"8CBFBA89-024D-4C08-8F3C-2A9AE3DE8EC6":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"AE6E77B9-ED7D-41A0-A61D-088E4B6A1435":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"60377860-93D8-43B1-ACC0-70EC609FF60E":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"E8F04F54-73A2-4FA8-B442-7BBA2A4DAF4A":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"08724571-529F-4761-943D-DE3C1C05977D":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"D707F921-2A2F-46C1-95FC-CED65F51C273":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"1C2DF990-B09A-4C58-8E6F-CB77BF859499":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap and hold the action to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"E035DA14-7702-491B-91DF-CFD3B0BB59AC":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"37157A45-F8F5-4DFE-8749-9AB941083204":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"1DCCDF10-6BA7-4FFE-9717-A0C98DC6C0C9":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"6ECBA1B4-D22F-40A2-B7B3-624202766A40":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."},"B28A16E6-64CC-4E60-8DC7-D37365C33BAF":{"type":"advancedText","tokenRanges":{},"text":"This action runs a Python script that can be configured with your own parameters. Tap the options (▼) button to edit the script or the parameters that are shown here. This comment is actually a text parameter itself – feel free to remove it."}}},{"pauseBeforeRunning":false,"pauseWithoutShowingParameters":false,"customTitle":"","class":"WorkflowActionOpenDocument","parameters":{"filename":"%var:Filename","inDropbox":false}}]}